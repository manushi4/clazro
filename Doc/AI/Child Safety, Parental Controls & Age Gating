 # Child Safety, Parental Controls & Age Gating

## 1. Purpose

This guide defines the **mandatory safety framework** for children and minors across AI, automation, widgets, tools, and external integrations. It ensures the platform is **age-appropriate, consent-driven, auditable, and compliant**, while preserving flexibility for teens and adults.

This document is **non-optional** for any feature that can be accessed by users under 18.

---

## 2. Core Safety Principles (Non‑Negotiable)

1. **Safety overrides functionality**
2. **Age rules override role rules**
3. **No silent autonomy for minors**
4. **Parental visibility by default**
5. **Human escalation over AI confidence**
6. **Minimal data exposure**

Any feature violating these principles must not ship.

---

## 3. Age Groups & Classification

Age gating is determined at **account creation** and re‑evaluated on age transitions.

| Group | Age Range | Risk Level | Autonomy |
| ----- | --------- | ---------- | -------- |
| Child | < 13      | Very High  | None     |
| Teen  | 13–17     | Medium     | Limited  |
| Adult | 18+       | Low        | Full     |

Age classification is **authoritative** and cannot be overridden by AI or UI logic.

---

## 4. Child (<13) Safety Rules

### 4.1 AI Interaction Rules

* No free‑form, unbounded chat
* Prompt templates must be **locked**
* Short, guided, instructional responses only
* No speculative or open‑ended answers

### 4.2 Content Restrictions

* No sensitive topics (violence, self‑harm, sexuality, substances, ideology)
* No persuasive or opinionated content
* No external links unless whitelisted

### 4.3 Tool & Connector Restrictions

* ❌ No direct tool usage (calendar, email, docs)
* ❌ No MCP tool calls
* ✅ Only indirect actions approved by parent/coach

### 4.4 Automation Rules

* No autonomous automations
* All triggers must notify parent/coach
* Automations run in **read‑only or advisory mode**

### 4.5 Visibility & Logging

* Parents/coaches can view:

  * prompts
  * responses
  * safety flags
* Logs are immutable

---

## 5. Teen (13–17) Safety Rules

### 5.1 AI Interaction Rules

* Structured chat allowed
* Explicit refusals required
* Safety‑filtered explanations

### 5.2 Content Restrictions

* Sensitive topics require neutral framing
* Advice must be informational, not prescriptive

### 5.3 Tool & Connector Rules

* Limited tool usage with confirmation
* No background tool execution

### 5.4 Automation Rules

* User‑initiated only
* No silent background workflows

### 5.5 Escalation

* Repeated safety flags trigger adult review

---

## 6. Parental Controls

### 6.1 Control Surface (Platform Studio + App)

Parents can:

* Enable/disable AI features
* Restrict topics
* Set usage time windows
* Review history and summaries
* Approve or reject automations

### 6.2 Consent Model

* Explicit opt‑in required for:

  * AI usage
  * data processing
  * external tool exposure
* Consent is versioned and auditable

---

## 7. Age Transitions

When a user crosses an age boundary:

* Features are re‑evaluated
* Prompts and permissions migrate
* Parents are notified
* New consent may be required

No automatic privilege escalation.

---

## 8. Enforcement Architecture

Safety is enforced at **multiple layers**:

1. **Platform Studio** – config validation
2. **AI & Automation Gateway** – runtime enforcement
3. **Prompt Templates** – profile‑locked
4. **Tool Layer (MCP)** – allowlist + scope
5. **UI Widgets** – constrained UX

Failure at any layer triggers fallback.

---

## 9. Safety Signals & Escalation

### 9.1 Signals

* Repeated refusals
* Topic boundary hits
* Emotional distress indicators

### 9.2 Escalation Path

AI → Safe Response → Adult Notification → Human Review

AI must **never** handle crisis alone.

---

## 10. Data Retention & Privacy

* Child data retention minimized
* No training on child conversations
* Easy deletion upon request
* Regional compliance respected

---

## 11. Testing & Validation

Required tests:

* Age‑based prompt validation
* Forbidden topic penetration tests
* Automation misuse scenarios
* Parental visibility verification

---

## 12. Audit & Compliance

Every child‑related AI interaction must record:

* age group
* feature invoked
* policy version
* outcome (answer/refusal/escalation)

---

## 13. Non‑Negotiables (Summary)

* Children never get unrestricted AI
* Parents always have visibility
* Automations never act silently
* Safety rules override product goals

---

This guide is foundational for trust, legality, and long‑term platform credibility.


---

## 14. Database Schema for Child Safety

### 14.1 Audience Profiles Table

```sql
CREATE TABLE ai_audience_profiles (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  customer_id UUID REFERENCES customers(id),
  profile_id TEXT NOT NULL, -- 'kid', 'teen', 'adult', 'coaching'
  display_name TEXT NOT NULL,
  min_age INTEGER,
  max_age INTEGER,
  -- Behavior Rules
  tone TEXT DEFAULT 'friendly',
  max_response_length INTEGER DEFAULT 500,
  allowed_topics TEXT[] DEFAULT '{}',
  forbidden_topics TEXT[] DEFAULT '{}',
  -- Tool Policy
  tools_allowed BOOLEAN DEFAULT false,
  -- Safety
  safety_level TEXT DEFAULT 'strict',
  require_parent_visibility BOOLEAN DEFAULT false,
  config JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(customer_id, profile_id)
);
```


### 14.2 Default Profiles

```sql
INSERT INTO ai_audience_profiles (customer_id, profile_id, display_name, min_age, max_age, 
  tone, max_response_length, forbidden_topics, tools_allowed, safety_level, require_parent_visibility)
VALUES
  (NULL, 'kid', 'Child', 0, 12, 'friendly', 200, 
   ARRAY['violence', 'self-harm', 'sexuality', 'substances', 'ideology'], 
   false, 'strict', true),
  (NULL, 'teen', 'Teen', 13, 17, 'friendly', 500, 
   ARRAY['explicit-content', 'self-harm-methods'], 
   false, 'standard', true),
  (NULL, 'adult', 'Adult', 18, NULL, 'professional', 2000, 
   ARRAY[], true, 'relaxed', false),
  (NULL, 'coaching', 'Coaching', 18, NULL, 'professional', 4000, 
   ARRAY[], true, 'relaxed', false);
```


---

## 15. Age Detection Function

```sql
CREATE OR REPLACE FUNCTION get_audience_profile(p_user_id TEXT)
RETURNS TEXT AS $$
DECLARE
  user_age INTEGER;
  profile TEXT;
BEGIN
  -- Calculate age from user_profiles (assuming birth_date column)
  SELECT EXTRACT(YEAR FROM AGE(CURRENT_DATE, birth_date))
  INTO user_age
  FROM user_profiles WHERE user_id = p_user_id;
  
  IF user_age IS NULL THEN
    RETURN 'adult'; -- Default if no birth date
  ELSIF user_age < 13 THEN
    RETURN 'kid';
  ELSIF user_age < 18 THEN
    RETURN 'teen';
  ELSE
    RETURN 'adult';
  END IF;
END;
$$ LANGUAGE plpgsql;
```

---

## 16. Related Documentation

- `Doc/AI/AI_IMPLEMENTATION_APPENDIX.md` - Complete schemas
- `Doc/AI/Ai Permissions, Consent & Rbac` - Consent model
- `src/hooks/useDemoUser.ts` - User context hook
